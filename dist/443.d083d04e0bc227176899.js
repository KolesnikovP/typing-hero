"use strict";(self.webpackChunkreact_app_template=self.webpackChunkreact_app_template||[]).push([[443],{4443:function(e,n,r){r.r(n),r.d(n,{default:function(){return D}});var a,t=r(5893),o=r(4478),l=r(1150),i=r(7168);!function(e){e.INCORRECT_USER_DATA="INCORRECT_USER_DATA",e.INCORRECT_USER_AGE="INCORRECT_USER_AGE",e.INCORRECT_USER_COUNTRY="INCORRECT_USER_COUNTRY",e.NO_DATA="NO_DATA",e.SERVER_ERROR="SERVER_ERROR"}(a||(a={}));var c=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.form},u=(0,i.hg)("profile/updateProfileData",(function(e,n){return r=void 0,t=void 0,l=function(){var e,r,t,o,l,i;return function(e,n){var r,a,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){l.label=o[1];break}if(6===o[0]&&l.label<t[1]){l.label=t[1],t=o;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(o);break}t[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(u){switch(u.label){case 0:if(e=n.extra,r=n.rejectWithValue,t=n.getState,o=c(t()),(l=function(e){if(!e)return[a.NO_DATA];var n=e.firstname,r=e.lastname,t=e.age,o=e.country,l=[];return n&&r||l.push(a.INCORRECT_USER_DATA),t||l.push(a.INCORRECT_USER_AGE),o||l.push(a.INCORRECT_USER_COUNTRY),l}(o)).length)return[2,r(l)];u.label=1;case 1:return u.trys.push([1,3,,4]),[4,e.api.put("/profile",o)];case 2:return[2,u.sent().data];case 3:return i=u.sent(),console.log(i),[2,r([a.SERVER_ERROR])];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,n){function a(e){try{c(l.next(e))}catch(e){n(e)}}function i(e){try{c(l.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof o?r:new o((function(e){e(r)}))).then(a,i)}c((l=l.apply(r,t||[])).next())}));var r,t,o,l})),s=(0,i.hg)("profile/fetchProfileData",(function(e,n){return r=void 0,a=void 0,o=function(){var e,r,a;return function(e,n){var r,a,t,o,l={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,a&&(t=2&o[0]?a.return:o[0]?a.throw||((t=a.return)&&t.call(a),0):a.next)&&!(t=t.call(a,o[1])).done)return t;switch(a=0,t&&(o=[2&o[0],t.value]),o[0]){case 0:case 1:t=o;break;case 4:return l.label++,{value:o[1],done:!1};case 5:l.label++,a=o[1],o=[0];continue;case 7:o=l.ops.pop(),l.trys.pop();continue;default:if(!((t=(t=l.trys).length>0&&t[t.length-1])||6!==o[0]&&2!==o[0])){l=0;continue}if(3===o[0]&&(!t||o[1]>t[0]&&o[1]<t[3])){l.label=o[1];break}if(6===o[0]&&l.label<t[1]){l.label=t[1],t=o;break}if(t&&l.label<t[2]){l.label=t[2],l.ops.push(o);break}t[2]&&l.ops.pop(),l.trys.pop();continue}o=n.call(e,l)}catch(e){o=[6,e],a=0}finally{r=t=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}}(this,(function(t){switch(t.label){case 0:n.dispatch,e=n.extra,r=n.rejectWithValue,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.api.get("/profile")];case 2:return[2,t.sent().data];case 3:return a=t.sent(),console.log(a),[2,r("error")];case 4:return[2]}}))},new((t=void 0)||(t=Promise))((function(e,n){function l(e){try{c(o.next(e))}catch(e){n(e)}}function i(e){try{c(o.throw(e))}catch(e){n(e)}}function c(n){var r;n.done?e(n.value):(r=n.value,r instanceof t?r:new t((function(e){e(r)}))).then(l,i)}c((o=o.apply(r,a||[])).next())}));var r,a,t,o})),f=function(){return f=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},f.apply(this,arguments)},d=(0,i.oM)({name:"profile",initialState:{readonly:!0,isLoading:!1,error:void 0,data:void 0},reducers:{setReadonly:function(e,n){e.readonly=n.payload},cancelEdit:function(e){e.readonly=!0,e.validateErrors=void 0,e.form=e.data},updateProfile:function(e,n){e.form=f(f({},e.form),n.payload)}},extraReducers:function(e){e.addCase(s.pending,(function(e,n){e.error=void 0,e.isLoading=!0})).addCase(s.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload})).addCase(s.rejected,(function(e,n){e.isLoading=!1,e.error=n.payload})).addCase(u.pending,(function(e,n){e.validateErrors=void 0,e.isLoading=!0})).addCase(u.fulfilled,(function(e,n){e.isLoading=!1,e.data=n.payload,e.form=n.payload,e.readonly=!0,e.validateErrors=void 0})).addCase(u.rejected,(function(e,n){e.isLoading=!1,e.validateErrors=n.payload}))}}),p=d.actions,v=d.reducer,h=r(4611),y=r(4809),m=r(6925),R=r(5507),g=r(7808),b=r(7294),C=function(e){var n=e.className,r=e.src,a=e.size,o=e.alt,l=(0,b.useMemo)((function(){return{width:a||100,height:a||100}}),[a]);return(0,t.jsx)("img",{src:r,alt:o,className:(0,h.A)("ZqPdwJxd",{},[n]),style:l})},x={data:"mem1neCT",input:"ZTyX8_n9",loading:"t07ZxFGs",error:"i5YK3SSb",AvatarWrapper:"pDak2W8a",Name:"yUTg_wgx"},E=function(){return E=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},E.apply(this,arguments)},N=function(e){var n=e.className,r=e.data,a=e.error,l=e.isLoading,i=e.onChangeAge,c=e.onChangeCountry,u=e.onChangeLastName,s=e.onChangeFirstName,f=e.onChangeUsername,d=e.onChangeAvatar,p=e.readonly,v=(0,o.$)("profile").t;return l?(0,t.jsx)("div",E({className:(0,h.A)(x.ProfileCard,{},[n,x.loading])},{children:(0,t.jsx)(R.a,{})})):a?(0,t.jsx)("div",E({className:(0,h.A)(x.ProfileCard,{},[n,x.error])},{children:(0,t.jsx)(y.x,{title:v("Ошибка"),text:v("Попробуйте перезагрузить"),align:"center",theme:y.l.ERROR})})):(0,t.jsx)("div",E({className:(0,h.A)(x.ProfileCard,{},[n])},{children:(0,t.jsxs)("div",E({className:x.data},{children:[(null==r?void 0:r.avatar)&&(0,t.jsxs)("div",E({className:x.AvatarWrapper},{children:[(0,t.jsx)(C,{src:null==r?void 0:r.avatar,size:70}),(0,t.jsx)(y.x,{className:x.Name,title:"".concat(null==r?void 0:r.firstname," ").concat(r.lastname)})]})),(0,t.jsx)(m.I,{value:null==r?void 0:r.firstname,label:v("Имя"),placeholder:v("Имя"),className:x.input,onChange:s,readonly:p}),(0,t.jsx)(m.I,{value:null==r?void 0:r.lastname,label:v("Фамилия"),placeholder:v("Фамилия"),className:x.input,onChange:u,readonly:p}),(0,t.jsx)(m.I,{value:null==r?void 0:r.age,label:v("Возраст"),placeholder:v("Возраст"),className:x.input,onChange:i,readonly:p}),(0,t.jsx)(g.P,{label:v("Страна"),value:null==r?void 0:r.age,placeholder:v("Страна"),className:x.input,onSelect:c,disabled:p,options:[{value:"Russia",data:"Russia"}]}),(0,t.jsx)(m.I,{value:null==r?void 0:r.nickname,label:v("Никнейм"),placeholder:v("Никнейм"),className:x.input,onChange:f,readonly:p}),(0,t.jsx)(m.I,{value:null==r?void 0:r.avatar,label:v("Аватар"),placeholder:v("Аватар"),className:x.input,onChange:d,readonly:p})]}))}))},O=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.error},j=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.isLoading},T=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.readonly},A=function(e){var n;return null===(n=e.profile)||void 0===n?void 0:n.validateErrors},_=r(3225),w=r(9704),I=r(9161),P={header:"BhPkjJEx",editBtn:"vP5lJqeW"},S=function(){return S=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},S.apply(this,arguments)},k=function(e){var n=e.className,r=(0,o.$)("profile").t,a=(0,w.v9)(T),l=(0,_.T)(),i=(0,b.useCallback)((function(){l(p.setReadonly(!1))}),[l]),c=(0,b.useCallback)((function(){l(u())}),[l]),s=(0,b.useCallback)((function(){l(p.cancelEdit())}),[l]);return(0,t.jsx)("div",S({className:(0,h.A)(P.ProfilePageHeader,{},[n])},{children:(0,t.jsxs)("div",S({className:P.header},{children:[(0,t.jsx)(y.x,{title:r("Профиль")}),a?(0,t.jsx)(I.zx,S({className:P.editBtn,theme:I.bn.OUTLINE,onClick:i},{children:r("Редактировать")})):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(I.zx,S({className:P.editBtn,theme:I.bn.OUTLINE_RED,onClick:s},{children:r("Отменить")})),(0,t.jsx)(I.zx,S({className:P.saveBtn,theme:I.bn.OUTLINE,onClick:c},{children:r("Сохранить")}))]})]}))}))},U=function(){return U=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},U.apply(this,arguments)},L={profile:v},D=function(e){e.className;var n,r=(0,o.$)("profile").t,i=(0,_.T)(),u=(0,w.v9)(c),f=(0,w.v9)(O),d=(0,w.v9)(j),v=(0,w.v9)(T),h=(0,w.v9)(A),m=((n={})[a.SERVER_ERROR]=r("Ошибка сервера при сохранении"),n[a.INCORRECT_USER_COUNTRY]=r("Неверно указана страна"),n[a.INCORRECT_USER_DATA]=r("Имя и фамилия обязательны"),n[a.INCORRECT_USER_AGE]=r("Некорректный возраст"),n[a.NO_DATA]=r("Данные не указаны"),n);(0,b.useEffect)((function(){i(s())}),[i]);var R=(0,b.useCallback)((function(e){i(p.updateProfile({firstname:e||""}))}),[i]),g=(0,b.useCallback)((function(e){i(p.updateProfile({lastname:e||""}))}),[i]),C=(0,b.useCallback)((function(e){i(p.updateProfile({age:Number(e||0)}))}),[i]),x=(0,b.useCallback)((function(e){i(p.updateProfile({country:e}))}),[i]),E=(0,b.useCallback)((function(e){i(p.updateProfile({nickname:e||""}))}),[i]),I=(0,b.useCallback)((function(e){i(p.updateProfile({avatar:e||""}))}),[i]);return(0,t.jsxs)(l.W,U({reducers:L,removeAfterUnmount:!0},{children:[(0,t.jsx)(k,{}),(null==h?void 0:h.length)&&h.map((function(e){return(0,t.jsx)(y.x,{theme:y.l.ERROR,title:m[e]},e)})),(0,t.jsx)(N,{data:u,isLoading:d,error:f,onChangeFirstName:R,onChangeLastName:g,onChangeAge:C,onChangeCountry:x,onChangeAvatar:I,onChangeUsername:E,readonly:v})]}))}},1150:function(e,n,r){r.d(n,{W:function(){return i}});var a=r(5893),t=r(4478),o=r(7294),l=r(9704),i=function(e){var n=e.children,r=e.reducers,i=e.removeAfterUnmount,c=((0,t.$)().t,(0,l.oR)()),u=(0,l.I0)();return(0,o.useEffect)((function(){return Object.entries(r).forEach((function(e){var n=e[0],r=e[1];c.reducerManager.add(n,r),u({type:"@INIT ".concat(n," reducer")})})),function(){i&&Object.entries(r).forEach((function(e){var n=e[0];e[1],c.reducerManager.remove(n),u({type:"@DESTROY ".concat(n," reducer")})}))}}),[]),(0,a.jsx)(a.Fragment,{children:n})}},3225:function(e,n,r){r.d(n,{T:function(){return t}});var a=r(9704),t=function(){return(0,a.I0)()}},6925:function(e,n,r){r.d(n,{I:function(){return c}});var a=r(5893),t=r(4611),o=r(7294),l={Label:"LCZkCFoV",Input:"X8EVbQ1x",readonly:"fTN1PnWu"},i=function(){return i=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},i.apply(this,arguments)},c=(0,o.memo)((function(e){var n,r=e.className,c=e.onChange,u=e.value,s=e.autoFocus,f=e.label,d=e.readonly,p=void 0!==d&&d,v=e.type,h=void 0===v?"text":v,y=function(e,n){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var t=0;for(a=Object.getOwnPropertySymbols(e);t<a.length;t++)n.indexOf(a[t])<0&&Object.prototype.propertyIsEnumerable.call(e,a[t])&&(r[a[t]]=e[a[t]])}return r}(e,["className","onChange","value","autoFocus","label","readonly","type"]),m=(0,o.useState)(!1),R=(m[0],m[1]),g=(0,o.useRef)(null);(0,o.useEffect)((function(){var e;s&&(R(!0),null===(e=g.current)||void 0===e||e.focus())}),[s]);var b=function(e){null==c||c(e.target.value)},C=((n={})[l.readOnly]=p,n);return(0,a.jsx)("div",i({className:(0,t.A)(l.InputWrapper,C,[r])},{children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",i({className:l.Label},{children:f})),(0,a.jsx)("input",i({value:u,className:l.Input,ref:g,type:h,onChange:b,readOnly:p},y))]}):(0,a.jsx)("input",i({value:u,className:l.Input,ref:g,type:h,onChange:b,readOnly:p},y))}))}))},4809:function(e,n,r){r.d(n,{x:function(){return u},l:function(){return a}});var a,t=r(5893),o=r(4611),l=r(7294),i={Title:"aC5SvzpA",Text:"Fs9ATJNs",secondary:"EkLYpykY",error:"F9oLXAK4",left:"dBqPIG8f",center:"iJw6m2iu",right:"j4UBrvei"},c=function(){return c=Object.assign||function(e){for(var n,r=1,a=arguments.length;r<a;r++)for(var t in n=arguments[r])Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e},c.apply(this,arguments)};!function(e){e.PRIMARY="primary",e.SECONDARY="secondary",e.ERROR="error"}(a||(a={}));var u=(0,l.memo)((function(e){var n,r=e.className,l=e.title,u=e.text,s=e.align,f=void 0===s?"left":s,d=e.theme,p=void 0===d?a.PRIMARY:d,v=((n={})[i.primary]=p===a.PRIMARY,n[i.secondary]=p===a.SECONDARY,n[i.error]=p===a.ERROR,n[i.left]="left"===f,n[i.center]="center"===f,n[i.right]="right"===f,n);return(0,t.jsxs)("div",c({className:(0,o.A)(i.TextWrapper,v,[r])},{children:[l&&(0,t.jsx)("p",c({className:i.Title},{children:l})),u&&(0,t.jsx)("p",c({className:i.Text},{children:u}))]}))}))}}]);